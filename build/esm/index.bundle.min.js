var re=Object.defineProperty,ne=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var D=(t,r,e)=>r in t?re(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,l=(t,r)=>{for(var e in r||(r={}))K.call(r,e)&&D(t,e,r[e]);if(H)for(var e of H(r))G.call(r,e)&&D(t,e,r[e]);return t},u=(t,r)=>ne(t,oe(r));var m=(t,r)=>{var e={};for(var n in t)K.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&H)for(var n of H(t))r.indexOf(n)<0&&G.call(t,n)&&(e[n]=t[n]);return e};import*as R from"react";import*as E from"react";function w(n){var o=n,{type:t,options:r}=o,e=m(o,["type","options"]);let a=E.createElement("input",u(l(l({tabIndex:0},t==="numeric"?{type:"text",inputMode:"numeric",pattern:"[0-9]*"}:{type:t}),e),{"aria-describedby":`${e.name}-hint`,"data-fgb":"input",list:Array.isArray(r)&&r.length?`${e.name}-options`:void 0}));return Array.isArray(r)&&r.length?E.createElement(E.Fragment,null,a,E.createElement("datalist",{id:`${e.name}-options`},r.map(i=>typeof i=="object"?E.createElement("option",{key:i.value,value:i.value},i.label):E.createElement("option",{key:i,value:i},i)))):a}import*as A from"react";import*as M from"react";function S(y){var d=y,{name:t,label:r,children:e,hint:n,hintClassName:o,labelClassName:a,group:i,labelStyle:p,hintStyle:s}=d,f=m(d,["name","label","children","hint","hintClassName","labelClassName","group","labelStyle","hintStyle"]);let x=`${t}-hint`;return M.createElement("fieldset",l({"data-fgb":"fieldset"},f),M.createElement("span",{id:x,"data-fgb":"hint",className:o,"aria-live":"polite","data-fgb-hint":n,style:l({order:2},s)},n),i?M.createElement("legend",{"data-fgb":"label",className:a,style:p},r):M.createElement("label",{htmlFor:t,"data-fgb":"label",className:a,style:p},r),e)}function U(i){var p=i,{type:t,name:r,options:e,label:n,defaultChecked:o}=p,a=m(p,["type","name","options","label","defaultChecked"]);return e.map(s=>{let{value:f,label:y}=typeof s=="object"?s:{label:s,value:s},d=`${r}-${f}`;return A.createElement(S,{name:d,label:y,key:f},A.createElement(w,u(l({},a),{type:t.startsWith("c")?"checkbox":"radio",name:r,id:d,value:String(f),"data-fgb-group":r,defaultChecked:Array.isArray(o)?o.some(x=>x===f):o===f})))})}import*as O from"react";function W(a){var i=a,{options:t,type:r,defaultSelected:e,name:n}=i,o=m(i,["options","type","defaultSelected","name"]);return O.createElement("select",u(l({name:n,tabIndex:0,"aria-describedby":`${n}-hint`},o),{"data-fgb":"input"}),t.map(p=>{let{value:s,label:f}=typeof p=="object"?p:{label:p,value:p};return O.createElement("option",{key:s,value:s,defaultChecked:!!e&&(o.multiple&&Array.isArray(e)?e.some(y=>y==s):e==s)},f)}))}import*as j from"react";function q(o){var a=o,{type:t,minRows:r=3,autosize:e}=a,n=m(a,["type","minRows","autosize"]);return j.createElement("textarea",u(l({},n),{onInput:e?i=>{let p=i.target;setTimeout(()=>{p.style.height="auto",p.style.height=`${p.scrollHeight}px`},0)}:void 0,"data-fgb":"input",rows:r}))}function _(t){return t.tagName==="FORM"}function I(t){return t.tagName==="INPUT"}function h(t){return t.tagName==="SELECT"}function b(t){return t.tagName==="TEXTAREA"}var g={badInput:"Malformed input.",required:"Required.",minLength:"Too short.",maxLength:"Too long.",pattern:"Invalid value.",min:"Too low.",max:"Too high.",step:"Off-step.",email:"Invalid email address.",url:"Invalid url."};function Te(t){g=l(l({},g),t)}function J(t){if(t.validity.badInput)return g.badInput;if(t.validity.valueMissing)return g.required;if(h(t))return"";if(t.validity.tooShort)return g.minLength;if(t.validity.tooLong)return g.maxLength;if(b(t))return"";if(t.validity.patternMismatch)return t.title||g.pattern;if(t.validity.rangeUnderflow)return g.min;if(t.validity.rangeOverflow)return g.max;if(t.validity.stepMismatch)return g.step;if(t.validity.typeMismatch){if(t.type==="email")return g.email;if(t.type==="url")return g.url}return""}function v(t,r){var o;let e=t.elements.namedItem(r);if(!e)throw new Error(`Cannot find field with name ${r}`);if("length"in e&&e.length){let a=Array.from(e);if(a[0].type==="radio")return(o=Array.from(a).find(i=>i.checked))==null?void 0:o.value;if(a[0].type==="checkbox")return Array.from(a).map(i=>i.checked?i.value:null).filter(Boolean);throw new Error(`Unexpected collection found in field name ${r}. Found type of ${a[0].type}`)}let n=e;if(h(n))return n.multiple?Array.from(n.selectedOptions).map(a=>a.value):n.value;if(I(n))return n.type==="file"?n.files:n.type==="email"&&n.multiple?n.value.split(/\s*,\s*/):n.type==="checkbox"&&n.dataset.fgbGroup!==n.name||n.type==="radio"?n.checked:n.value;if(b(n))return n.value;throw new Error(`Unexpected element found in field name ${r}. Found ${n.tagName}`)}function C(t,r,e){let n=t.elements.namedItem(r);if(!n)throw new Error(`Cannot find field with name ${r}`);if("length"in n&&n.length){let a=Array.from(n);if(a[0].type==="radio"){a.forEach(i=>{i.checked=i.value===e});return}if(a[0].type==="checkbox"){a.forEach(Array.isArray(e)?i=>{i.checked=e.includes(i.value)}:i=>{i.checked=i.value===e});return}throw new Error(`Unexpected collection found in field name ${r}. Found type of ${a[0].type}`)}let o=n;if(h(o)){if(o.multiple){Array.from(o.selectedOptions).forEach(Array.isArray(e)?a=>{a.selected=e.includes(a.value)}:a=>{a.selected=a.value===e});return}o.value=`${e}`;return}if(I(o)){if(o.type==="email"&&o.multiple&&Array.isArray(e)){o.value=e.join(",");return}if(o.type==="checkbox"&&o.dataset.fgbGroup!==o.name){o.checked=!!e;return}if(o.type==="radio"){o.checked=!!e;return}o.value=`${e}`;return}if(b(o)){o.value=`${e}`;return}throw new Error(`Unexpected element found in field name ${r}. Found type of ${o.type}`)}var z=t=>new FormData(t);function c(t,r,e){t[r]?(Array.isArray(t[r])||(t[r]=[t[r]]),t[r].push(e)):t[r]=e}var X=t=>{let r={};for(let e of Array.from(t.elements)){if(I(e))switch(e.type){case"number":case"range":c(r,e.name,+e.value);continue;case"radio":!e.checked&&!r[e.name]&&c(r,e.name,null),e.checked&&c(r,e.name,e.value);continue;case"checkbox":e.dataset.fgbGroup!==e.name?c(r,e.name,!!e.checked):!e.checked&&!r[e.name]?c(r,e.name,[]):e.checked&&c(r,e.name,e.value);continue;case"email":e.multiple?c(r,e.name,e.value.split(/\s*,\s*/)):c(r,e.name,e.value);continue;case"file":c(r,e.name,e.files);default:c(r,e.name,e.value);continue}h(e)&&(e.multiple?c(r,e.name,Array.from(e.selectedOptions).map(n=>n.value)):c(r,e.name,e.value)),b(e)&&c(r,e.name,e.value)}return r};import*as Q from"react";function T(t,r,e){var i;let n=t.elements.namedItem(r);if(!n)throw new Error(`Cannot find field with name ${r}`);let o="length"in n&&n.length?n.item(0):n;o.setCustomValidity(e);let a=(i=o.closest("[data-fgb='fieldset']"))==null?void 0:i.querySelector(`#${o.name}-hint`);a&&(a.textContent=e||a.dataset.fgbHint||"")}function k(t,r,e){let n=o=>{let a=o.validity.valid?"":J(o),i=v(o.form,o.name);return a=(r==null?void 0:r(i))||a,console.log({name:o.name,error:a,value:i,validated:r==null?void 0:r(i),validity:o.validity}),T(o.form,o.name,a),!!a};return{[t]:o=>(n(o.target),e==null?void 0:e(o)),onInvalid:o=>{n(o.target)&&o.preventDefault()}}}function Y(t){return(r,e)=>{let n=Array.isArray(e)?e:[e];return function(p){var s=p,{validators:a}=s,i=m(s,["validators"]);return Q.createElement(r,l(l({},i),k(t,a?n.concat(a):n,i[t])))}}}var Ue=Y("onChange"),We=Y("onBlur");function Z(t,r){let e=!0,n=r==null?void 0:r(o=>v(t,o),(o,a)=>C(t,o,a));for(let o of Array.from(t.elements)){if(!o.name)continue;let a=(n==null?void 0:n[o.name])||"",i=o.dispatchEvent(new Event("invalid",{cancelable:!0}))&&!a;(i||a)&&T(t,o.name,a),i||(e=!1)}return e}function N(t,r){return e=>{let n=_(e.target)?e.target:"form"in e.target?e.target.form:null;if(!n)throw new Error("Expected to find a form element attached to wrapped event target.");let o=t(a=>v(n,a),(a,i)=>C(n,a,i));if(o)for(let a of Object.keys(o))T(n,a,o[a]);return r==null?void 0:r(e)}}function Rt(t){let r=k(t.validateOnChange?"onChange":"onBlur",typeof t.validateOnChange=="function"?t.validateOnChange:typeof t.validateOnBlur=="function"?t.validateOnBlur:void 0,t[t.validateOnChange?"onChange":"onBlur"]),$=t,{label:e,hint:n,className:o,style:a,hintClassName:i,hintStyle:p,labelClassName:s,labelStyle:f,inputClassName:y,inputStyle:d,inputLabelClassName:x,inputLabelStyle:P,name:V,type:F="text"}=$,L=m($,["label","hint","className","style","hintClassName","hintStyle","labelClassName","labelStyle","inputClassName","inputStyle","inputLabelClassName","inputLabelStyle","name","type"]);return R.createElement(S,{label:e,name:V,hint:n,className:o,style:a,hintStyle:p,hintClassName:i,labelStyle:f,labelClassName:s,"data-fgb-type":F,group:F==="radios"||F==="checkboxes"},F==="select"?R.createElement(W,u(l(l({},L),r),{name:V,className:y,style:d})):F==="textarea"?R.createElement(q,u(l(l({},L),r),{name:V,className:y,style:d})):F==="checkboxes"||F==="radios"?R.createElement(U,u(l(l({},L),r),{type:F,name:V,className:x,style:P,inputClassName:y,inputStyle:d})):R.createElement(w,u(l(l({},L),r),{name:V,type:F,className:y,style:d})))}import*as ee from"react";function kt(f){var y=f,{dialog:t,method:r="post",action:e,submitFormData:n,submitJson:o,validateOnBlur:a,validateOnChange:i,autoComplete:p=!1}=y,s=m(y,["dialog","method","action","submitFormData","submitJson","validateOnBlur","validateOnChange","autoComplete"]);if(!n&&!o)throw new Error("Must supply a submit method prop of either `submitFormData` or `submitJson`.");return ee.createElement("form",u(l({},s),{"data-fgb":"form",noValidate:typeof window!==void 0,autoComplete:p?"on":"off",method:t?"dialog":r,action:e,onChange:i?N(i,s.onChange):void 0,onBlur:a?N(a,s.onBlur):void 0,onSubmit:d=>{let x=d.target;if(d.preventDefault(),Z(x,i||a||void 0)){let P=n?n(z(x)):o(X(x));(P&&P instanceof Promise?P:Promise.resolve(P)).then(V=>{if(!!V)for(let F of Object.keys(V))T(x,F,V[F])})}}}))}import*as te from"react";function B(t){var r;for(let e of Array.from(t.elements)){if(!e.name)continue;let n=(r=e.closest("[data-fgb='label']"))==null?void 0:r.querySelector(`#${e.name}-hint`);if(n!=null&&n.textContent)return!1}return!0}function $t(e){var n=e,{validate:t}=n,r=m(n,["validate"]);return te.createElement("button",u(l({},r),{type:"submit",ref:o=>{o&&o.form&&(o.disabled=!B(o.form),o.form.addEventListener(t==="onChange"?"input":"change",a=>{o.disabled=!B(o.form)}))}}))}export{Rt as Field,kt as Form,$t as Submit,J as getErrorMessage,v as getFormFieldValue,z as getFormValuesAsFormData,X as getFormValuesAsJson,_ as isFormElement,I as isInputElement,h as isSelectElement,b as isTextareaElement,Te as setDefaultErrorMessages,C as setFormFieldValue,Z as validateForm,N as validationEffectHandler,Y as withValidation,We as withValidationOnBlur,Ue as withValidationOnChange,k as wrapWithFieldValidation};
